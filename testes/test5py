from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.options import Options
import time

# ConfiguraÃ§Ã£o do Chrome com perfil do usuÃ¡rio
chrome_options = Options()
chrome_options.add_argument("user-data-dir=C:/Users/GestÃ£o MX/AppData/Local/Google/Chrome/User Data")
chrome_options.add_argument("profile-directory=Default")
chrome_options.add_argument("--disable-sync")

# Inicializa o WebDriver
driver = webdriver.Chrome(options=chrome_options)

try:
    # Solicita a OS no console
    os_input = input("Digite o nÃºmero da OS do GSPN (10 dÃ­gitos): ").strip()
    
    # URL da OS no GSPN
    url_gspn = f"https://biz6.samsungcsportal.com/gspn/operate.do?cmd=ZifGspnSvcMainLDCmd&objectID={os_input}#tabInfoHref"
    driver.get(url_gspn)
    
    time.sleep(3)  # Aguarda carregamento da pÃ¡gina

    # ðŸŸ¢ Clicar na aba "Agenda & Datas" para coletar o TOKEN_NO
    try:
        aba_agenda = driver.find_element(By.ID, "tdJob")
        aba_agenda.click()
        time.sleep(2)  # Aguarda o carregamento da aba
        
        token_no = driver.find_element(By.ID, "TOKEN_NO").get_attribute("value").strip()
    except:
        token_no = "NÃ£o encontrado"

    # ðŸŸ¢ Verificar se a aba "SAW" existe e coletar informaÃ§Ãµes
    saw_data = []
    try:
        aba_saw = driver.find_element(By.ID, "tdSAW")
        aba_saw.click()
        time.sleep(2)  # Aguarda o carregamento da aba

        # Coletar os dados da tabela de SAW
        tabela_saw = driver.find_element(By.ID, "divSAW")
        linhas_saw = tabela_saw.find_elements(By.TAG_NAME, "tr")

        for linha in linhas_saw[1:]:  # Pular o cabeÃ§alho
            try:
                categoria = linha.find_elements(By.TAG_NAME, "td")[2].text.strip()
                status = linha.find_elements(By.TAG_NAME, "td")[3].text.strip()
                saw_data.append({"categoria": categoria, "status": status})
            except:
                continue

    except:
        saw_data = "Nenhuma informaÃ§Ã£o de SAW encontrada"

    # ðŸŸ¢ Exibir as informaÃ§Ãµes no console
    print("\nðŸ”¹ **InformaÃ§Ãµes da OS no GSPN**")
    print(f"ðŸ“Œ TOKEN NO: {token_no}")
    print(f"ðŸ“Œ InformaÃ§Ãµes SAW: {saw_data}")

finally:
    input("\nPressione ENTER para fechar o navegador...")
    driver.quit()
4172074628